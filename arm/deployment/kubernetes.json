{
  "$schema":"https://schema.management.azure.com/schemas/2019-04-01/deploymentTemplate.json#",
  "languageVersion":"2.0",
  "contentVersion":"1.1.1.1",
  "apiProfile":"",
  "definitions":{},
  "parameters":{},
  "variables":{},
  "functions":[],
  "resources":{
    // "rg":{
    //   "type":"Microsoft.Resources/resourceGroups",
    //   "apiVersion":"2021-04-01",
    //   "name":"sloopstash-prd",
    //   "location":"Central India",
    //   "properties":{},
    //   "tags":{
    //     "Name":"sloopstash-prd",
    //     "Environment":"prd",
    //     "Region":"centralindia",
    //     "Organization":"sloopstash"
    //   }
    // }, 
    "vnet":{
      "apiVersion":"2024-05-01",
      "type":"Microsoft.Network/virtualNetworks",
      "name":"vnet",
      "location":"Central India",
      "properties":{
        "addressSpace":{
          "addressPrefixes":["11.1.0.0/16"]
        },
        "encryption":{
          "enabled":true,
          "enforcement":"AllowUnencrypted"
        },
        "subnets":[{
          "type":"Microsoft.Network/virtualNetworks/subnets",
          "name":"container-s2-vnet-aks-sn-1",
          "properties":{
            "addressPrefixes":["11.1.3.0/24"]
          }
        },{
          "type":"Microsoft.Network/virtualNetworks/subnets",
          "name":"container-s2-vnet-aks-sn-2",
          "properties":{
            "addressPrefixes":["11.1.4.0/24"]
          }
        }]
      },
      "tags":{
        "Name":"vnet",
        "Environment":"prd",
        "Region":"centralindia",
        "Organization":"sloopstash"
      }
    },
    "container_s2_aks_ct":{
      "apiVersion":"2024-09-02-preview",
      "type":"Microsoft.ContainerService/managedClusters",
      "dependsOn":["vnet"],
      "name":"container-s2-aks-ct",
      "location":"[resourceGroup().location]",
      "sku":{
        "name":"Base",
        "tier":"Free"
      },
      "identity":{
        "type":"SystemAssigned"
      },
      "properties":{
        "kubernetesVersion":"1.32",
        "dnsPrefix":"container-s2-aks-ct-api-endpoint",
        "apiServerAccessProfile":{
          "enablePrivateCluster":false,
          "authorizedIPRanges":["0.0.0.0/0"],
          "disableRunCommand":false
        },
        "networkProfile":{
          "networkPlugin":"kubenet",
          "networkPolicy":"calico",
          "ipFamilies":["IPv4"],
          "loadBalancerSku":"standard"
        },
        "nodeResourceGroup":"container-s2-aks-ct-rg",
        "agentPoolProfiles":[{
          "name":"nodepool1",
          "vmSize":"Standard_D2as_v4",
          "type":"VirtualMachineScaleSets",
          "osSKU":"AzureLinux",
          "vnetSubnetID":"[resourceId('Microsoft.Network/virtualNetworks/subnets','vnet','container-s2-vnet-aks-sn-1')]",
          "enableNodePublicIP":false,
          "enableUltraSSD":false,
          "enableEncryptionAtHost":false,
          "mode":"System",
          "orchestratorVersion":"1.32",
          "workloadRuntime":"OCIContainer",
          "enableAutoScaling":true,
          "maxCount":1,
          "minCount":1,
          "count":1,
          "maxPods":50
        }],
        "autoUpgradeProfile":{
          "upgradeChannel":"patch",
          "nodeOSUpgradeChannel":"NodeImage"
        },
        "enableRBAC":true,
        "enablePodSecurityPolicy":false,
        "securityProfile":{
          "imageCleaner":{
            "enabled":false
          }
        },
        "oidcIssuerProfile":{
          "enabled":false
        }
      },
      "tags":{
        "Name":"container-s2-aks-ct",
        "Environment":"prd",
        "Region":"centralindia",
        "Organization":"sloopstash"
      }
    }
  },
  "outputs":{}
}
 